package entities

import (
	"time"

	"github.com/nurdsoft/redesign-grp-trust-portal-api/shared/nullable"
)

type Vulnerabilities struct {
	Links     []Links         `json:"links"`
	Page      Page            `json:"page"`
	Resources []Vulnerability `json:"resources"`
}

type V2 struct {
	AccessComplexity      string  `json:"accessComplexity"`
	AccessVector          string  `json:"accessVector"`
	Authentication        string  `json:"authentication"`
	AvailabilityImpact    string  `json:"availabilityImpact"`
	ConfidentialityImpact string  `json:"confidentialityImpact"`
	ExploitScore          float64 `json:"exploitScore"`
	ImpactScore           float64 `json:"impactScore"`
	IntegrityImpact       string  `json:"integrityImpact"`
	Score                 float64 `json:"score"`
	Vector                string  `json:"vector"`
}
type V3 struct {
	AttackComplexity      string  `json:"attackComplexity"`
	AttackVector          string  `json:"attackVector"`
	AvailabilityImpact    string  `json:"availabilityImpact"`
	ConfidentialityImpact string  `json:"confidentialityImpact"`
	ExploitScore          float64 `json:"exploitScore"`
	ImpactScore           float64 `json:"impactScore"`
	IntegrityImpact       string  `json:"integrityImpact"`
	PrivilegeRequired     string  `json:"privilegeRequired"`
	Scope                 string  `json:"scope"`
	Score                 float64 `json:"score"`
	UserInteraction       string  `json:"userInteraction"`
	Vector                string  `json:"vector"`
}
type Cvss struct {
	Links []Links `json:"links"`
	V2    V2      `json:"v2"`
	V3    V3      `json:"v3"`
}
type Description struct {
	HTML string `json:"html"`
	Text string `json:"text"`
}
type Pci struct {
	AdjustedCVSSScore     int    `json:"adjustedCVSSScore"`
	AdjustedSeverityScore int    `json:"adjustedSeverityScore"`
	Fail                  bool   `json:"fail"`
	SpecialNotes          string `json:"specialNotes"`
	Status                string `json:"status"`
}
type Vulnerability struct {
	Added           string      `json:"added"`
	Categories      []string    `json:"categories"`
	Cves            []string    `json:"cves"`
	Cvss            Cvss        `json:"cvss"`
	DenialOfService bool        `json:"denialOfService"`
	Description     Description `json:"description"`
	Exploits        string      `json:"exploits"`
	ID              string      `json:"id"`
	Links           []Links     `json:"links"`
	MalwareKits     string      `json:"malwareKits"`
	Modified        string      `json:"modified"`
	Pci             Pci         `json:"pci"`
	Published       string      `json:"published"`
	RiskScore       float64     `json:"riskScore"`
	Severity        string      `json:"severity"`
	SeverityScore   int         `json:"severityScore"`
	Title           string      `json:"title"`
}

type LastNexVulnerabilityScan struct {
	LastVulnerabilityScan time.Time `json:"last_vulnerability_scan" gorm:"column:last_vulnerability_scan"`
	NextVulnerabilityScan time.Time `json:"next_vulnerability_scan" gorm:"column:next_vulnerability_scan"`
}

type VulnerabilitySeverityCountsByInterval struct {
	Date     time.Time `json:"date"`
	Severity string    `json:"severity"`
	Count    int       `json:"count"`
}

type FactSiteCounts struct {
	Vulnerabilities         int `json:"vulnerabilities" gorm:"column:vulnerabilities"`
	CriticalVulnerabilities int `json:"critical_vulnerabilities" gorm:"column:critical_vulnerabilities"`
	SevereVulnerabilities   int `json:"severe_vulnerabilities" gorm:"column:severe_vulnerabilities"`
	ModerateVulnerabilities int `json:"moderate_vulnerabilities" gorm:"column:moderate_vulnerabilities"`
}

type TopRemediationTask struct {
	SolutionId       int                 `json:"solution_id" gorm:"column:solution_id"`
	VulnerabilityId  int                 `json:"vulnerability_id" gorm:"column:vulnerability_id"`
	RiskScore        float64             `json:"risk_score" gorm:"column:vulnerabilities"`
	Severity         nullable.NullString `json:"severity" gorm:"column:severity"`
	Title            nullable.NullString `json:"title" gorm:"column:vulnerabilities"`
	IssueDescription nullable.NullString `json:"issue_description" gorm:"column:vulnerabilities"`
	RemediationName  nullable.NullString `json:"remediation_name" gorm:"column:vulnerabilities"`
	RemediationLink  nullable.NullString `json:"remediation_link" gorm:"column:vulnerabilities"`
	SolutionStep     nullable.NullString `json:"solution_step" gorm:"column:vulnerabilities"`
}

type Remediation struct {
	RecommendationUrl nullable.NullString `json:"recommendation_url"`
	IssueDescription  nullable.NullString `json:"issue_description"`
	VulnerabilityId   int                 `json:"vulnerability_id"`
	SolutionId        int                 `json:"solution_id"`
	Source            nullable.NullString `json:"source"`
	RiskScore         float64             `json:"risk_score"`
	Severity          nullable.NullString `json:"severity"`
	Instances         int                 `json:"instances"`
	IssueName         nullable.NullString `json:"issue_name"`
	Recommendation    nullable.NullString `json:"recommendation"`
}
